(()=>{var e={295:e=>{let t=0;e.exports={generateCourse:function(){let e;return e=0===t?{boundary:[{x:10,y:40},{x:30,y:40},{x:30,y:45},{x:65,y:45},{x:65,y:40},{x:90,y:40},{x:90,y:60},{x:65,y:60},{x:65,y:55},{x:30,y:55},{x:30,y:60},{x:10,y:60}],obstacles:[[{x:15,y:55},{x:25,y:55},{x:25,y:45},{x:15,y:45}]],initialGolfBallPosition:{x:80,y:50},hole:{position:{x:12.5,y:50},radius:2.1}}:{boundary:[{x:88.38,y:37.15},{x:84.15,y:48.92},{x:72.43,y:61.96},{x:55.25,y:68.69},{x:37.56,y:67.01},{x:25.61,y:60.48},{x:14.06,y:45.26},{x:11,y:31.88},{x:88.38,y:31.61},{x:88.38,y:35.05},{x:23.92,y:34.88},{x:27.44,y:43.97},{x:34.52,y:51.55},{x:44.18,y:55.89},{x:53.69,y:56.27},{x:64.4,y:52.28},{x:71.5,y:45.55},{x:75.56,y:37.12}],initialGolfBallPosition:{x:80,y:40},hole:{position:{x:86,y:33.4},radius:1.5}},t++,e}}}},t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}(()=>{"use strict";const e="hsl(120, 100%, 50%)",t={golfBallAttributes:{r:.8,fill:"white","stroke-width":5,stroke:"black","stroke-opacity":"0"},directionLineAttributes:{stroke:e,"stroke-width":.5,fill:"none","stroke-linecap":"round"},boundaryAttributesOuter:{stroke:"black","stroke-width":2,fill:"none"},boundaryAttributesInner:{stroke:"white",fill:"#3ab93a"},obstacleAttributes:{stroke:"white",fill:"black"},holeAttributes:{r:1,fill:"black"},extentPadding:.1,zoomFactor:.9,centerMouseInterpolation:.1,scrollDelay:.02};t.boundaryAttributesInner["stroke-width"]=0,t.obstacleAttributes["stroke-width"]=0;const o=function(e){const t=[];let n,o,i=!1;return{addButton:function(e,n,o=[]){const i=function(e,t,n=[]){const o=document.createElement("div");return o.setAttribute("id",e),o.textContent=t,(n=n.concat(["menu-button"])).forEach((e=>o.classList.add(e))),o}(e,n,o);return t.push(i),i},setTitle:function(e,t=[]){n=function(e,t=[]){const n=document.createElement("div");return n.innerHTML=e,n.setAttribute("id","menu-title"),t.forEach((e=>n.classList.add(e))),n}(e,t)},createMenuElement:function(){o=function(e,t,n){const o=document.createElement("div");o.setAttribute("id",e),o.classList.add("menu"),o.appendChild(t);const i=document.createElement("div");i.classList.add("menu-element-container");for(const e of n)i.appendChild(e);return o.appendChild(i),o}(e,n,t)},getMenuElement:function(){return o},setActive:function(){console.log("active"),i=!0},setNotActive:function(){i=!1},addCustomElement:function(e){t.push(e)},addRestrictedEventListener:function(e,t,n){e.addEventListener(t,(function(e){i&&n(e)}))}}},i=o("singeplayer-menu"),r=document.createElement("div");r.innerHTML='\n<div id="singleplayer-numcourse-container" class="menu-option-container">\n    <div class=\'menu-options-header\'>Number of courses</div>\n    <div id="singleplayer-numcourse-input-container" class="menu-inner-option-container">\n        <textarea rows="1" id="singleplayer-numcourses-input"></textarea>\n        <div id="singleplayer-numcourses-increase" class="menu-button">+</div>\n        <div id="singleplayer-numcourses-decrease" class="menu-button">-</div>\n        <div id="singleplayer-numcourses-infinite" class="menu-button">∞</div>\n    </div>\n</div>\n',i.addCustomElement(r);const s=i.addButton("start-button","Start game");i.addRestrictedEventListener(s,"click",(()=>{console.log("start"),document.querySelector("#game-container").classList.remove("hidden"),Ne.hide()}));const a=i.addButton("back-button","Go back");i.addRestrictedEventListener(a,"click",(()=>Ne.setMenu(ke,!1))),i.setTitle("Single-player game",["title-small"]),i.createMenuElement();const l=i,c=o("multiplayer-menu"),u=c.addButton("start-button","Start game");c.addRestrictedEventListener(u,"click",(()=>console.log("start")));const d=c.addButton("back-button","Go back");c.addRestrictedEventListener(d,"click",(()=>Ne.setMenu(ke,!1))),c.setTitle("Multi-player game",["title-small"]),c.createMenuElement();const m=c;function h(e){const t=e.createSVGPoint();return function(n){return t.x=n.x,t.y=n.y,t.matrixTransform(e.getScreenCTM().inverse())}}function f(e,t){if(t)for(const n in t)e.setAttribute(n,t[n])}function p(e,t,n){const o=document.createElementNS("http://www.w3.org/2000/svg",e);return n?.forEach((e=>o.classList.add(e))),f(o,t),o}function g(e,t,n,o,i){o.x1=t.x||t.getX(),o.y1=t.y||t.getY(),o.x2=n.x||n.getX(),o.y2=n.y||n.getY();const r=p("line",o,i);return e.append(r),r}function y(e,t,n,o){const i=t.map((e=>`${e.x||e.getX()},${e.y||e.getY()}`)).join(" ");n.points=i;const r=p("polygon",n,o);return e.append(r),r}function v(e,t,n,o){n.cx=t.x||t.getX(),n.cy=t.y||t.getY();const i=p("circle",n,o);return e.append(i),i}function x(e,t,n,o){const i=e[0]+e[2]/2,r=e[1]+e[3]/2,s=i+o*(t.x-i),a=r+o*(t.y-r),l=n*e[2],c=n*e[3];return[s-l/2,a-c/2,l,c]}function b({x:e,y:t}){let n,o=e,i=t;function r(){return n||(n=Math.sqrt(o**2+i**2)),n}return{getX:function(){return o},setX:function(e){o=e},getY:function(){return i},setY:function(e){i=e},getPerpendicular:function(){return b({x:-i,y:o})},getLength:r,normalize:function(){const e=r();0!=e&&(o/=e,i/=e)},getCoordinates:function(){return{x:o,y:i}},getNormalized:function(){return b({x:o/r(),y:i/r()})},getDirection:function(){return Math.atan2(i,o)},getString:function(){return`[x: ${o}, y: ${i}]`}}}function L(e,t){return e.getX()*t.getX()+e.getY()*t.getY()}function E(e,t){return e.getX()*t.getY()-t.getX()*e.getY()}function C(e,t){return b({x:e.getX()+t.getX(),y:e.getY()+t.getY()})}function w(e,t){return b({x:e.getX()-t.getX(),y:e.getY()-t.getY()})}function P(e,t){return b({x:t*e.getX(),y:t*e.getY()})}function B(e){return b({x:Math.cos(e),y:Math.sin(e)})}function M(e,t){let n=e,o=t,i=w(o,n);function r(){return i.getLength()}return{getLength:r,getStartVertex:function(){return n},getEndVertex:function(){return o},getDifferenceVector:function(){return i},getString:function(){return`Start: ${n.getString()}, end: ${o.getString()}`},computePositionProportion:function(n){const o=w(e,n).getLength(),i=w(t,n).getLength(),s=o/r();return i>r()?-s:s}}}function S(e,t){let n=e,o=t;return{getInitialPoint:function(){return n},getDirectionVector:function(){return o},getPositionAtTime:function(e){return C(n,P(o,e))},getString:function(){return`Initial point: ${n.getString()}, direction: ${o.getString()}`}}}function G(e,t){const n=e.getInitialPoint(),o=e.getDirectionVector(),i=t.getStartVertex(),r=t.getDifferenceVector(),s=w(i,n),a=E(o,r);if(0===a)return;const l=E(s,r)/a,c=E(s,o)/a;return{intersectionPoint:e.getPositionAtTime(l),pathParameter:l,edgeParameter:c}}function k(e,t,n){return e>=t&&e<=n}function N(e,t,n){const o=e.getInitialPoint(),i=e.getDirectionVector(),r=n.getStartVertex(),s=n.getEndVertex(),a=n.getDifferenceVector();let l=(t*a.getLength()+L(o.getPerpendicular(),a)+L(r,s.getPerpendicular()))/L(i,a.getPerpendicular()),c=e.getPositionAtTime(l);const u=E(w(r,c),w(s,c));let d=b({x:c.getX()+u*a.getY()/a.getLength()**2,y:c.getY()-u*a.getX()/a.getLength()**2});const m=n.computePositionProportion(d);if(k(m,0,1))return{time:l,collisionCenter:c,collisionPoint:d};d=k(m,-1/0,0)?r:s;const h=w(o,d);return l=-(Math.sqrt(L(h,i)**2-i.getLength()**2*(h.getLength()**2-t**2))+L(h,i))/i.getLength()**2,c=e.getPositionAtTime(l),{time:l,collisionCenter:c,collisionPoint:d}}const T=function(e){const t=e.getGolfBall(),n=e.getCourse(),o=n.getEdges(),i=n.getHole(),r=Math.sqrt(Infinity/(2*t.getRadius()))*(2*i.radius-t.getRadius());let s;console.log(r);let a,l=!1,c=!1;function u(){const e=t.getPosition(),n=B(t.getDirection()),i=S(e,n),r=function(e,t){const n=e.getDirectionVector(),o=n.getNormalized().getPerpendicular(),i=C(e.getInitialPoint(),P(o,t)),r=w(e.getInitialPoint(),P(o,t));return{pathA:S(i,n),pathB:S(r,n)}}(i,t.getRadius());let s={time:1/0};for(const e of o){const n=G(r.pathA,e),o=G(r.pathB,e);if(n&&o&&(k(n.edgeParameter,0,1)&&k(n.pathParameter,0,1/0)||k(o.edgeParameter,0,1)&&k(o.pathParameter,0,1/0))){const n=N(i,t.getRadius(),e);n.time<s.time&&(s=n)}}let a=function(e,t){const n=w(e,function(e,t){const n=L(e,t)/t.getLength()**2;return P(t,n)}(e,t));return w(e,P(n,2))}(n,w(s.collisionPoint,s.collisionCenter));a=P(a,-1);const l=Math.atan2(a.getY(),a.getX());return s.directionAfterCollision=l,s}function d(e){s||(s=u());const n=(o=t.getPosition(),w(s.collisionCenter,o).getLength());var o;if(t.getSpeed()*e>n){const o=n/t.getSpeed();t.step(o);const i=(1-.5*o)*t.getSpeed();t.setSpeed(i),t.setDirection(s.directionAfterCollision);const r=e-o;s=null,f(),d(r)}else{t.step(e);const n=(1-.5*e)*t.getSpeed();t.setSpeed(n),t.getSpeed()<.5&&(t.setSpeed(0),l=!1),f()}}function m(e,t){for(let n=0;n<t;n++){if(!l)return;d(e/t)}}function h(t){if(!l)return;a||(a=t);let n=(t-a)/1e3;n>1/60&&l&&(a=t,m(n,5*Math.round(60*n))),l?window.requestAnimationFrame(h):(s=null,l=!1,a=null,e.setPlayerFinished(c),e.golfBallStoppedMoving())}function f(){const e=t.getPosition(),n=t.getSpeed();w(e,i.position).getLength()<=i.radius&&n<r&&(l=!1,c=!0)}return{step:d,multipleSteps:m,stepLoop:h,executePutt:function(){l=!0,c=!1,window.requestAnimationFrame(h)},checkIfRunning:function(){return l}}};function A(e){let t=e.slice(4).slice(0,-1).split(",").map((e=>parseFloat(e.trim().replace("%",""))));return{h:t[0],s:t[1],l:t[2]}}function V(e,t,n){let o;if(e<=2)o=360*(e-1)/2;else{let t=Math.ceil(Math.log2(e));o=360*(2*(e-2**(t-1))-1)/2**t}return`hsl(${o}, ${t}%, ${n}%)`}var D=n(295);function _(e){this.rootSVGElement=e,this._computeSVGPosition=h(e),this.isPlayerFinished=!1,this._handleGolfBallMouseDown=this._handleGolfBallMouseDown.bind(this),this._handleGolfBallMouseMove=this._handleGolfBallMouseMove.bind(this),this._handleGolfBallMouseUp=this._handleGolfBallMouseUp.bind(this),this._handleGolfBallTouchStart=this._handleGolfBallTouchStart.bind(this),this._handleGolfBallTouchMove=this._handleGolfBallTouchMove.bind(this),this._handleGolfBallTouchEnd=this._handleGolfBallTouchEnd.bind(this),this._handleEscapePutt=this._handleEscapePutt.bind(this)}_.prototype.setNumberOfCourses=function(e){this.numberOfCourses=e},_.prototype.setPlayerFinished=function(e){this.isPlayerFinished=e},_.prototype._setNewGolfBall=function(e){this.golfBall=function(e,n,o,i){let r,s=b(e.initialGolfBallPosition),a=n,l=o,c=e.golfBallRadius||.8,u=B(l),d=!1;function m(){r=v(i,s.getCoordinates(),t.golfBallAttributes,["golf-ball"])}function h(e){s=e,y()}function p(e){a=e}function g(e){l=e,u=B(l)}function y(){!function(e,t){f(e,{cx:t.x,cy:t.y})}(r,s.getCoordinates())}function x(){d=!0,r.classList.add("user-clickable")}function L(){s=b(e.initialGolfBallPosition),console.log(s.getCoordinates()),h(s)}return{initialize:function(){m(),x()},draw:m,getPosition:function(){return s},setPosition:h,getSpeed:function(){return a},setSpeed:p,getDirection:function(){return l},setDirection:g,getRadius:function(){return c},setRadius:function(e){c=e},destroy:function(){r.remove()},step:function(e){const t=a*e;let n=s;n.setX(n.getX()+t*u.getX()),n.setY(n.getY()+t*u.getY()),h(n)},update:y,addEventListener:function(e,t){r.addEventListener(e,t)},removeEventListener:function(e,t){r.removeEventListener(e,t)},setUserClickable:x,setNotUserClickable:function(){d=!1,r.classList.remove("user-clickable")},checkUserClickable:function(){return d},moveToInitialPosition:L,reset:function(){L(),p(0),g(0)},getInitialPosition:function(){return b(e.initialGolfBallPosition)}}}(e,0,0,this.rootSVGElement),this.golfBall.initialize(),this.golfBall.addEventListener("mousedown",this._handleGolfBallMouseDown),this.golfBall.addEventListener("touchstart",this._handleGolfBallTouchStart)},_.prototype.getGolfBall=function(){return this.golfBall},_.prototype._setNewCourse=function(e){this.course=function(e,n){const o=e.boundary,i=e.obstacles,r=b(e.hole.position),s=e.hole.radius;let a;const l={xMin:1/0,xMax:-1/0,yMin:1/0,yMax:-1/0};let c=[];function u(){y(a,o,t.boundaryAttributesOuter,["course-boundary","course-boundary-outer"]),y(a,o,t.boundaryAttributesInner,["course-boundary","course-boundary-inner"]),i?.forEach((e=>{y(a,e,t.obstacleAttributes,["course-obstacle"])}));const e=t.holeAttributes;e.r=s,v(a,r,e,["course-hole"])}return{draw:u,initialize:function(){a=p("g",null,["course-container"]),n.append(a),function(){const e=[...o];e.push(e[0]);for(let t=1;t<e.length;t++){const n=e[t-1],o=e[t];c.push(M(b({x:n.x,y:n.y}),b({x:o.x,y:o.y}))),l.xMin=Math.min(l.xMin,n.x),l.xMax=Math.max(l.xMax,n.x),l.yMin=Math.min(l.yMin,n.y),l.yMax=Math.max(l.yMax,n.y)}i?.forEach((e=>{const t=[...e];t.push(t[0]);for(let e=1;e<t.length;e++){const n=t[e-1],o=t[e];c.push(M(b({x:n.x,y:n.y}),b({x:o.x,y:o.y})))}}))}(),u()},getBoundaryVertices:function(){return o},getObstacles:function(){return i},getEdges:function(){return c},getHole:function(){return{position:r,radius:s}},destroy:function(){a.remove()},getCourseAABB:function(){return l}}}(e,this.rootSVGElement),this.course.initialize()},_.prototype.getCourse=function(){return this.course},_.prototype.setGameContent=function(e){this._cleanUpGame(),this.courseData=e,this._setNewCourse(this.courseData),this._setNewGolfBall(this.courseData),this.gameMechanics=T(this),this.resizeViewBoxToCourse()},_.prototype.resizeViewBoxToCourse=function(){!function(e,t,n){const o=t.xMax-t.xMin,i=t.yMax-t.yMin,r=`${t.xMin-n*o} ${t.yMin-n*i} ${(1+2*n)*o} ${(1+2*n)*i}`;e.setAttribute("viewBox",r)}(this.rootSVGElement,this.course.getCourseAABB(),t.extentPadding)},_.prototype.generateNewCourse=function(){const e=(0,D.generateCourse)();this.setGameContent(e)},_.prototype._handleGolfBallMouseDown=function(e){if(e.stopPropagation(),!this.golfBall.checkUserClickable())return;const n=this.golfBall.getPosition();this.directionLineElement=g(this.rootSVGElement,n,n,t.directionLineAttributes,["direction-line"]),window.addEventListener("mousemove",this._handleGolfBallMouseMove),window.addEventListener("mouseup",this._handleGolfBallMouseUp),window.addEventListener("keydown",this._handleEscapePutt)},_.prototype._handleGolfBallTouchStart=function(){if(!this.golfBall.checkUserClickable())return;const e=this.golfBall.getPosition();directionLineElement=g(this.rootSVGElement,e,e,t.directionLineAttributes,["direction-line"]),this.rootSVGElement.addEventListener("touchmove",this._handleGolfBallTouchMove),this.rootSVGElement.addEventListener("touchend",this._handleGolfBallTouchEnd)},_.prototype._handleGolfBallMouseMove=function(e){const t=this._computeSVGPosition({x:e.clientX,y:e.clientY});this._updateDirectionLine(t)},_.prototype._handleGolfBallTouchMove=function(e){e.preventDefault();const t=e.changedTouches[0],n=this._computeSVGPosition({x:t.clientX,y:t.clientY});this._updateDirectionLine(n)},_.prototype._handleEscapePutt=function(e){"Escape"==e.key&&(window.removeEventListener("mousemove",this._handleGolfBallMouseMove),window.removeEventListener("mouseup",this._handleGolfBallMouseUp),window.removeEventListener("keydown",this._handleEscapePutt),this.directionLineElement.remove(),this.directionLineElement=null,this.directionLineVector=null)},_.prototype._updateDirectionLine=function(e){let t;if(this.directionLineVector=w(b(e),this.golfBall.getPosition()),this.directionLineVector.getLength()>20){const e=this.directionLineVector.getNormalized();this.directionLineVector=P(e,20),t=C(this.golfBall.getPosition(),this.directionLineVector)}else t=e;var n;f(this.directionLineElement,{x2:(n=t).x||n.getX(),y2:n.y||n.getY()});const o=function(e,t,n){const o=A("hsl(120, 100%, 50%)"),i=A("hsl(0, 100%, 50%)"),r=(1-n)*o.s+n*i.s,s=(1-n)*o.l+n*i.l;let a=i.h-o.h;return a+=Math.abs(a)>180?a<0?360:-360:0,`hsl(${o.h+n*a}, ${r}%, ${s}%)`}(0,0,this.directionLineVector.getLength()/20);f(this.directionLineElement,{stroke:o})},_.prototype._handleGolfBallMouseUp=function(){window.removeEventListener("mousemove",this._handleGolfBallMouseMove),window.removeEventListener("mouseup",this._handleGolfBallMouseUp),window.removeEventListener("keydown",this._handleEscapePutt),this.directionLineElement.remove(),this.directionLineElement=null,this.directionLineVector&&(this.computeGolfBallVelocity(),this.golfBall.setNotUserClickable(),this.directionLineVector=null,this.executePutt())},_.prototype._handleGolfBallTouchEnd=function(){this.rootSVGElement.removeEventListener("touchmove",this._handleGolfBallTouchMove),this.rootSVGElement.removeEventListener("touchend",this._handleGolfBallTouchEnd),this.directionLineElement.remove(),this.directionLineElement=null,this.directionLineVector&&(this.computeGolfBallVelocity(),this.golfBall.setNotUserClickable(),this.directionLineVector=null,this.executePutt())},_.prototype.computeGolfBallVelocity=function(){const e=this.directionLineVector.getDirection()+Math.PI,t=40*this.directionLineVector.getLength()/20;console.log(`speed: ${t}, direction: ${e}`),this.golfBall.setDirection(e),this.golfBall.setSpeed(t)},_.prototype.executePutt=function(){this.gameMechanics.executePutt()},_.prototype.golfBallStoppedMoving=function(){this.golfBall.setUserClickable()},_.prototype._cleanUpGame=function(){this.course?.destroy(),this.golfBall?.destroy(),this.course=null,this.golfBall=null,this.gameMechanics=null,this.courseData=null},_.prototype.setGolfBallSpeed=function(e){this.golfBall.setSpeed(e)},_.prototype.setGolfBallDirection=function(e){this.golfBall.setDirection(e)},_.prototype.setGolfBallPosition=function(e){const t=b(e);console.log(t.getCoordinates()),this.golfBall.setPosition(t),this.golfBall.update()},_.prototype.show=function(){this.rootSVGElement.classList.remove("hidden")},_.prototype.hide=function(){this.rootSVGElement.classList.add("hidden")},_.prototype.update=function(){this.golfBall.update()};const I=_,q=(()=>{const e=document.querySelector("#previous-course");e.addEventListener("click",(function(){s||0===a||(a--,d())}));const t=document.querySelector("#next-course");t.addEventListener("click",(function(){s||a===c.length-1||(a++,d())}));const n=document.querySelector("#course-summary"),o=document.querySelector("#current-course"),i=[e,t,n,o],r=document.querySelector("#table-content");let s,a,l,c;function u(){s=!1,a=0,l={},c=[]}function d(){if(0===c.length)return void h("No data yet");const{courseName:e,scores:t}=c[a];t.sort(((e,t)=>e.score-t.score)),h("Hole "+e),f();for(const e of t)p(e.name,e.score)}function m(){if(h("Totals"),0===c.length)return;const e={};for(const t of c)for(const n of t.scores)e[n.name]||(e[n.name]=0),e[n.name]+=n.score;const t=[];Object.keys(e).forEach((n=>t.push({name:n,score:e[n]}))),t.sort(((e,t)=>e.score-t.score)),f();for(const e of t)p(e.name,e.score)}function h(e){o.textContent=e}function f(){r.innerHTML=""}function p(e,t){const n=document.createElement("div");n.innerHTML=`<p>${e}</p><p>${t}</p>`,r.appendChild(n)}function g(){s?m():d()}return u(),n.addEventListener("click",(function(){s?(i.forEach((e=>e.classList.remove("course-summary-enabled"))),d()):(i.forEach((e=>e.classList.add("course-summary-enabled"))),m()),s=!s})),d(),{updateScoreTable:g,resetScoreboard:function(){u(),g()},incrementPlayerScore:function(e,t){e in l||(l[e]=c.length,c.push({courseName:e,scores:[]}));const n=l[e],o=c[n].scores,i=o.findIndex((e=>e.name===t));-1!==i?o[i].score+=1:o.push({name:t,score:1}),a=n,g()},setScoreArray:function(e){c=e,g()}}})(),O=(()=>{const e=document.querySelector("#player-list-container"),t=[],n={},o={};function i(e){return e in o||(o[e]=V(t.length,50,60)),o[e]}return{addPlayer:function(r){t.push(r),o[r]=V(t.length,50,60),n[r]=function(t){const n=document.createElement("div");return n.classList.add("player-list-element"),n.style.backgroundColor=i(t),n.textContent=t,e.appendChild(n),n}(r)},removePlayer:function(e){const i=t.findIndex((t=>t===e));-1!==i&&(delete t[i],delete o[e],n[e].remove(),delete n[e])},show:function(){e.classList.remove("hidden")},hide:function(){e.classList.add("hidden")},getPlayerColor:i,clear:function(){e.innerHTML="",t=[],n={},o={}}}})(),R=(()=>{const e=document.querySelector("#chat-box-container"),t=document.querySelector("#chat-box"),n=document.querySelector("#chat-input");let o;function i(){const e=n.value;if(n.focus(),!e.trim())return;const t=ee.getGameId(),o=ee.getPlayerId(),i={eventName:"messageSent"};i.data={gameId:t,playerId:o,message:e},ee.sendMessage(JSON.stringify(i)),n.value=""}return n.addEventListener("keydown",(e=>{"Enter"===e.key&&i()})),document.querySelector("#chat-send-message-button").addEventListener("click",i),{receiveMessage:function(e,n){const o=document.createElement("div");o.classList.add("chat-element"),o.innerHTML='<span class="chat-playername"></span>: <span class="chat-message"></span>';const i=o.querySelector(".chat-playername"),r=o.querySelector(".chat-message");i.textContent=e,i.style.color=O.getPlayerColor(e),r.textContent=n,t.insertBefore(o,t.firstChild)},setLocalPlayerName:function(e){o=e},receiveAnnouncement:function(e){const n=document.createElement("div");n.classList.add("chat-element","chat-announcement"),n.textContent=e,t.insertBefore(n,t.firstChild)},show:function(){e.classList.remove("hidden")},hide:function(){e.classList.add("hidden")},clear:function(){t.innerHTML="",o=null}}})();function Y(){document.querySelector("main").classList.add("blur")}function $(){document.querySelector("main").classList.remove("blur")}const X=function(e,t){Y();const n=`<div class='dialog-box-wrapper not-selectable'>\n            <div class='backdrop'></div>\n            <div class='dialog-box'>\n                <div class='dialog-box-description'>${e}</div>\n                <div class='dialog-box-button-container'>\n                </div>\n            </div>\n        </div>`,o=document.createElement("div");o.innerHTML=n;const i=o.querySelector(".dialog-box-button-container");for(const e of t){const t=document.createElement("div");function r(t){"function"==typeof e.callback&&e.callback(t),$(),o.remove()}t.classList.add("dialog-box-button"),t.textContent=e.text,t.addEventListener("click",r),i.appendChild(t)}document.body.appendChild(o)},U=(()=>{const e=document.querySelector("#game-container"),t=document.querySelector("#sidebar-body"),n=document.querySelector("#sidebar");document.querySelector("#sidebar-toggle").addEventListener("click",(function(){s?(t.classList.remove("hidden"),n.removeAttribute("style")):(t.classList.add("hidden"),n.style.bottom="initial"),s=!s,console.log(s)}));const o=document.querySelector("#current-course-number"),i=document.querySelector("#total-number-of-courses");let r,s=!1,a=1;document.querySelector("#sidebar-exit-button").addEventListener("click",(function(){const e=[];e.push({text:"Leave game",callback:()=>{ee.hideGame(),ee.exit()}}),e.push({text:"Cancel"}),X("Are you sure you want to leave the game?",e)}));const l="players",c="chat";let u=c;const d=t.querySelector("#show-players");d.addEventListener("click",(function(){u!==l&&(u=l,R.hide(),O.show(),m.classList.remove("chat-player-selected"),d.classList.add("chat-player-selected"),h.textContent=u)}));const m=t.querySelector("#show-chat");m.addEventListener("click",(function(){u!==c&&(u=c,R.show(),O.hide(),d.classList.remove("chat-player-selected"),m.classList.add("chat-player-selected"),h.textContent=u)}));const h=t.querySelector("#chat-player-title");return{show:function(){e.classList.remove("hidden")},hide:function(){e.classList.add("hidden")},setNumberOfCourses:function(e){r=e,i.textContent=r},getNumberOfCourses:function(){return r},incrementCurrentCourse:function(){a++,o.textContent=a},setCurrentCourse:function(e){a=e,o.textContent=a}}})(),H=document.querySelector("#game-announcement"),z=function(e,t){function n(){H.textContent="",H.removeEventListener("transitionend",n)}H.textContent=e,H.style.opacity=1,H.addEventListener("transitionend",(function e(){setTimeout((()=>{H.style.opacity=0,"function"==typeof t&&t(),H.removeEventListener("transitionend",e),H.addEventListener("transitionend",n)}),1e3)}))};function F(e){I.call(this,e)}F.prototype=Object.create(I.prototype),F.prototype._handleGolfBallMouseUp=function(){window.removeEventListener("mousemove",this._handleGolfBallMouseMove),window.removeEventListener("mouseup",this._handleGolfBallMouseUp),window.removeEventListener("keydown",this._handleEscapePutt),this.directionLineElement.remove(),this.directionLineElement=null,this.directionLineVector&&(this.computeGolfBallVelocity(),this.golfBall.setNotUserClickable(),this.directionLineVector=null,ee.sendPuttMessage())},F.prototype.setCurrentPlayer=function(e){this.currentPlayer=e,this.currentPlayer===ee.getPlayerName()?this.golfBall.setUserClickable():this.golfBall.setNotUserClickable()},F.prototype.setCurrentCourseName=function(e){this.currentCourseName=e},F.prototype.getCurrentCourseName=function(){return this.currentCourseName},F.prototype.getGolfBallVelocity=function(){return{golfBallSpeed:this.golfBall.getSpeed(),golfBallDirection:this.golfBall.getDirection()}},F.prototype.setFinalPosition=function(e){this.finalPosition=b(e)},F.prototype.storeNextPlayer=function(e){this.hasNextPlayer=!0,this.nextPlayer=e},F.prototype.storeNewCourseData=function(e,t){this.newCourseName=t,this.hasNewCourse=!0,this.newCourseData=e},F.prototype.golfBallStoppedMoving=function(){this.golfBall.setPosition(this.finalPosition),this.hasNewCourse?z(`NEW HOLE, NEXT PLAYER: ${this.nextPlayer}!`,(()=>{this.switchToNewCourse(),this.switchToNextPlayer(),U.incrementCurrentCourse(),this.checkGolfBallClickable()})):this.hasNextPlayer?z(`NEXT PLAYER: ${this.nextPlayer}!`,(()=>{this.switchToNextPlayer(),this.golfBall.moveToInitialPosition(),this.checkGolfBallClickable()})):this.checkGolfBallClickable()},F.prototype.checkGolfBallClickable=function(){this.currentPlayer===ee.getPlayerName()&&this.golfBall.setUserClickable()},F.prototype.switchToNextPlayer=function(){this.setCurrentPlayer(this.nextPlayer),this.hasNextPlayer=!1,this.nextPlayer=null},F.prototype.switchToNewCourse=function(){this.setGameContent(this.newCourseData),this.currentCourseName=this.newCourseName,this.hasNewCourse=!1,this.newCourseData=null,this.newCourseName=null},F.prototype.resetGolfBall=function(){this.golfBall.reset(),this.finalPosition=this.golfBall.getInitialPosition()};const J=F,j=document.querySelector("#svg-container");let W=(new Date).getTime();j.addEventListener("wheel",(function(e){const n=(new Date).getTime();if(n-W<1e3*t.scrollDelay)return;const o=h(this)({x:e.clientX,y:e.clientY}),i=this.getAttribute("viewBox").split(" ").map((e=>parseFloat(e)));let r;r=(e.deltaY>0?1:-1)<0?x(i,o,t.zoomFactor,t.centerMouseInterpolation):x(i,o,1/t.zoomFactor,0),this.setAttribute("viewBox",r.join(" ")),W=n})),j.addEventListener("mousedown",(function(e){let t={x:e.clientX,y:e.clientY};const n=j.querySelector(".course-container");function o(e){const o=n.getBoundingClientRect(),i=n.getBBox(),r=j.getAttribute("viewBox").split(" ").map((e=>parseFloat(e))),s={x:e.clientX,y:e.clientY};let a=s.x-t.x,l=s.y-t.y;a=a*i.width/o.width,l=l*i.height/o.height,r[0]-=a,r[1]-=l,j.setAttribute("viewBox",r.join(" ")),t=s}window.addEventListener("mousemove",o),window.addEventListener("mouseup",(function e(){window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",e)}))}));const K=j,Q=function(e){X(`Error: ${e.errorDescription}`,[{text:"Ok"}])},Z={handleGameCreationSuccessful:function(e){console.log(e);const t=ee.createGame();t.setGameContent(e.courseData),t.setCurrentPlayer(e.currentPlayer),t.setCurrentCourseName(e.courseName),ee.setPlayerId(e.playerId),ee.setGameId(e.gameId);for(const t of e.playerNames)O.addPlayer(t);ee.showGame(),U.setNumberOfCourses(e.numberOfCourses),U.setCurrentCourse(1)},handlePlayerJoined:function(e){O.addPlayer(e.playerName),R.receiveAnnouncement(`${e.playerName} has joined the game`)},handlePlayerLeft:function(e){O.removePlayer(e.playerName),R.receiveAnnouncement(`${e.playerName} has left the game`);const t=ee.getGame();e.currentPlayerLeft&&(t.resetGolfBall(),e.isNewCourse?z(`NEW HOLE, NEXT PLAYER: ${e.newCurrentPlayerName}`,(()=>{t.setGameContent(e.newCourseData),t.setCurrentCourseName(e.newCourseName),t.setCurrentPlayer(e.newCurrentPlayerName)})):z(`NEXT PLAYER: ${e.newCurrentPlayerName}`,(()=>{t.setCurrentPlayer(e.newCurrentPlayerName)})))},handleMessageReceived:function(e){R.receiveMessage(e.playerName,e.message)},handleJoinRequestSuccessful:function(e){console.log(e),ee.createGame(),ee.setPlayerId(e.playerId),ee.setGameId(e.gameId);const t=ee.createGame();t.setGameContent(e.courseData),t.setCurrentCourseName(e.courseName);for(const t of e.playerNames)O.addPlayer(t);t.setCurrentPlayer(e.currentPlayer),t.setGolfBallPosition(e.golfBallPosition),ee.showGame(),q.setScoreArray(e.scoreArray),U.setNumberOfCourses(e.numberOfCourses),U.setCurrentCourse(e.courseNumber)},handleExecutePutt:function(e){const t=ee.getGame(),n=e.playerName,o=e.golfBallSpeed,i=e.golfBallDirection,r=e.finalPosition;e.isFinished&&t.storeNextPlayer(e.nextPlayer),e.isNewCourse&&t.storeNewCourseData(e.newCourseData,e.newCourseName),console.log(t.getCurrentCourseName()),q.incrementPlayerScore(t.getCurrentCourseName(),n),t.setGolfBallSpeed(o),t.setGolfBallDirection(i),t.setFinalPosition(r),t.executePutt()},handleGeneralError:Q},ee=(()=>{let e,t,n,o,i;function r(e){console.log(JSON.parse(e.data));const t=JSON.parse(e.data);let n=t.eventName,o=t.data;n=n[0].toUpperCase()+n.slice(1);const i="handle"+n;i in Z?Z[i](o):Q(o)}function s(e){t.send(e)}function a(){X("Could not connect to server. Please try again later",[{text:"Ok"}])}return{createGame:function(){return e=new J(K),e},getGame:function(){return e},createWSClient:function(){return t=new WebSocket("wss://84.212.77.102:5600"),t.addEventListener("message",r),t.addEventListener("error",a),t},closeWSClient:function(){t&&(t.close(),t=null)},sendMessage:s,setGameId:function(e){n=e},getGameId:function(){return n},setPlayerId:function(e){o=e},getPlayerId:function(){return o},setPlayerName:function(e){i=e},getPlayerName:function(){return i},sendPuttMessage:function(){const{golfBallSpeed:t,golfBallDirection:i}=e.getGolfBallVelocity(),r={eventName:"executePutt"};r.data={playerId:o,gameId:n,golfBallSpeed:t,golfBallDirection:i},s(JSON.stringify(r))},exit:function(){t.close(),t=null,e=null,n=null,o=null,i=null},showGame:function(){Ne.hide(),e.show(),U.show()},hideGame:function(){e.hide(),U.hide(),Ne.show()}}})();function te(e){return[...e.toLowerCase()].every((e=>{const t=e.charCodeAt(0);return t>=97&&t<=122||t>=48&&t<=57||45===t}))}const ne=o("new-online-game-menu"),oe=document.createElement("div");oe.innerHTML='\n<div id="create-player-name" class="menu-inner-option-container menu-text-option">\n    <div id="create-player-name-label" class="option-label">Your name</div>\n    <textarea id="create-player-name-input" rows="1" placeholder="max 20 characters"></textarea>\n</div>',ne.addCustomElement(oe);const ie=oe.querySelector("#create-player-name-input"),re=document.createElement("div");re.innerHTML='\n<div id="create-game-id" class="menu-inner-option-container menu-text-option">\n    <div id="create-game-id-label" class="option-label">Game ID</div>\n    <textarea id="create-game-id-input" rows="1" placeholder="optional"></textarea>\n</div>',ne.addCustomElement(re);const se=re.querySelector("#create-game-id-input"),ae=document.createElement("div");ae.innerHTML='\n<div id="create-number-courses" class="menu-inner-option-container menu-text-option">\n    <div id="create-number-courses-label" class="option-label">Number of holes</div>\n    <textarea id="create-number-courses-input" rows="1" placeholder="must be ≥ 1"></textarea>\n</div>',ne.addCustomElement(ae);const le=ae.querySelector("#create-number-courses-input"),ce=ne.addButton("create-button","Create game");ne.addRestrictedEventListener(ce,"click",(function(){const e=ie.value,t=se.value,n=le.value;e?e.length>20?X("The name entered is too long",[{text:"Ok"}]):!n||n<1?X("The number of holes must be a number greater than 0",[{text:"Ok"}]):t&&!te(t)?X("The game ID can only consist of letters, numbers and hyphens (-)",[{text:"Ok"}]):(ee.setPlayerName(e),ee.createWSClient().addEventListener("open",(()=>function(e,t,n){const o={eventName:"newOnlineGame"};o.data={playerName:e,gameId:t,isGameIdSpecified:Boolean(t),numberOfCourses:n},ee.sendMessage(JSON.stringify(o))}(e,t,n)))):X("Please enter a name",[{text:"Ok"}])}));const ue=ne.addButton("back-button","Go back");ne.addRestrictedEventListener(ue,"click",(()=>Ne.setMenu(we,!1))),ne.setTitle("New online game",["title-small"]),ne.createMenuElement();const de=ne,me=o("join-online-game-menu"),he=document.createElement("div");he.innerHTML='\n<div id="create-player-name" class="menu-inner-option-container menu-text-option">\n    <div id="create-player-name-label" class="option-label">Your name</div>\n    <textarea id="create-player-name-input" rows="1" placeholder="max 20 characters"></textarea>\n</div>',me.addCustomElement(he);const fe=he.querySelector("#create-player-name-input"),pe=document.createElement("div");pe.innerHTML='\n<div id="create-game-id" class="menu-inner-option-container menu-text-option">\n    <div id="create-game-id-label" class="option-label">Game ID</div>\n    <textarea id="create-game-id-input" rows="1"></textarea>\n</div>',me.addCustomElement(pe);const ge=pe.querySelector("#create-game-id-input"),ye=me.addButton("join-button","Join game");me.addRestrictedEventListener(ye,"click",(function(){const e=fe.value,t=ge.value;e?e.length>20?dialogBox("The name entered is too long",[{text:"Ok"}]):t&&!te(t)?dialogBox("The game ID can only consist of letters, numbers and hyphens (-)",[{text:"Ok"}]):(ee.setPlayerName(e),ee.createWSClient().addEventListener("open",(()=>function(e,t){const n={eventName:"joinRequest"};n.data={playerName:e,gameId:t},ee.sendMessage(JSON.stringify(n))}(e,t)))):dialogBox("Please enter a name",[{text:"Ok"}])}));const ve=me.addButton("back-button","Go back");me.addRestrictedEventListener(ve,"click",(()=>Ne.setMenu(we,!1))),me.setTitle("Join online game",["title-small"]),me.createMenuElement();const xe=me,be=o("online-game-menu"),Le=be.addButton("new-game-button","Create new game");be.addRestrictedEventListener(Le,"click",(()=>Ne.setMenu(de)));const Ee=be.addButton("join-game-button","Join game");be.addRestrictedEventListener(Ee,"click",(()=>Ne.setMenu(xe)));const Ce=be.addButton("back-button","Go back");be.addRestrictedEventListener(Ce,"click",(()=>Ne.setMenu(ke,!1))),be.setTitle("Online game",["title-small"]),be.createMenuElement();const we=be,Pe=o("main-menu"),Be=Pe.addButton("singleplayer-button","Single-player");Pe.addRestrictedEventListener(Be,"click",(()=>Ne.setMenu(l,!0)));const Me=Pe.addButton("multiplayer-button","Local multi-player");Pe.addRestrictedEventListener(Me,"click",(()=>Ne.setMenu(m,!0)));const Se=Pe.addButton("online-button","Online game");Pe.addRestrictedEventListener(Se,"click",(()=>Ne.setMenu(we,!0))),Pe.setTitle('Minig<svg id="title-hole" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 260 260" xml:space="preserve">\n<path d="M0.5,0.5v259h259V0.5H0.5z M130.5,234.5C72.2,234.5,25,187.3,25,129S72.2,23.5,130.5,23.5\n\tS236,70.7,236,129S188.8,234.5,130.5,234.5z"/>\n</svg>lf');const Ge=document.createElement("div");Ge.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" id="menu-about-button" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\nviewBox="0 0 254 254">\n<path d="M127,0.5C57.1,0.5,0.5,57.1,0.5,127S57.1,253.5,127,253.5S253.5,196.9,253.5,127\nS196.9,0.5,127,0.5z M146.5,227h-36v-36h36V227z M189,112.6c-4.5,7.1-14.1,16.8-28.8,29c-7.6,6.3-12.3,11.7-14.2,15.5\nc-1.8,3.8-2.7,11.9-2.5,20.9h-32.7c-0.1-4-0.1-7.8-0.1-8.9c0-10.6,1.8-19.5,5.3-26.3c3.5-6.8,10.5-14.6,21-23.2\nc10.5-8.6,16.8-14.2,18.9-16.8c3.2-4.2,4.7-8.8,4.7-13.9c0-7-2.8-13-8.4-18c-5.6-5-13.2-7.5-22.7-7.5c-9.2,0-16.8,2.6-23,7.8\nc-6.2,5.2-10.4,13.2-12.7,23.9L60.7,91c0.9-15.3,7.5-28.3,19.6-39c12.1-10.7,28-16,47.7-16c20.7,0,37.2,5.4,49.4,16.2\nC189.6,63,195.7,75.6,195.7,90C195.7,97.9,193.5,105.5,189,112.6z"/>\n</svg>',Pe.addRestrictedEventListener(Ge,"click",(()=>alert("about"))),Pe.addCustomElement(Ge),Pe.createMenuElement();const ke=Pe,Ne=(()=>{const e=document.querySelector("#menu-wrapper");let t,n;function o(e,t,n,o="ease-in-out"){e.style.transitionDuration=`${n}s`,e.style.transform=`translateX(${t}px)`,e.style.transitionTimingFunction=o}function i(i,r=!0,s=!1){t&&t.setNotActive(),t=i;let a=r?1:-1,l=n;n=i.getMenuElement(),e.insertBefore(n,e.firstChild),l&&(l.ontransitionstart="",l.ontransitionend=""),n.ontransitionstart="",n.ontransitionend="";const c=document.body.offsetWidth;let u;const d=n.offsetWidth;l&&(u=l.offsetWidth);const m=(c+Math.max(d,u))/2;s||o(n,a*m,0),l&&!s&&(o(l,-a*m,.5,"ease-in-out"),l.addEventListener("transitionstart",(e=>{e.target==l&&(o(n,0,.5,"ease-in-out"),n.addEventListener("transitionend",(e=>{e.target==n&&(n.removeAttribute("style"),t.setActive())})))})),l.addEventListener("transitionend",(e=>{e.target==l&&(l.removeAttribute("style"),l.remove(),l=null)}))),s&&t.setActive()}return{setMenu:i,hide:function(){e.classList.add("hidden"),e.innerHTML="",t.setNotActive(),t=null,n=null},show:function(){e.classList.remove("hidden"),i(ke,!0,!0)}}})();name;const Te=new URLSearchParams(window.location.search).get("game-id");Te&&function(e,t,n){Y();const o=`<div class='input-box-wrapper not-selectable'>\n        <div class='backdrop'></div>\n        <div class='input-box'>\n            <div class='input-box-description'>${e}</div>\n            <div class='input-box-field-container'>\n              \n            </div>\n            <div class='input-box-button-container'>\n                \n            </div>\n        </div>\n    </div>`,i=document.createElement("div");i.innerHTML=o;const r=i.querySelector(".input-box-field-container"),s=i.querySelector(".input-box-button-container"),a={};for(const{fieldName:e,text:n}of t){const t=document.createElement("div");t.classList.add("input-box-field-element");const o=document.createElement("div");o.classList.add("input-box-parameter-name"),o.textContent=n,t.appendChild(o);const i=document.createElement("input");i.classList.add("input-box-field-input"),t.appendChild(i),r.appendChild(t),a[e]=i}for(const e of n){const t=document.createElement("div");function l(t){"function"==typeof e.callback&&e.callback(t,c()),$(),i.remove()}t.classList.add("input-box-button"),t.textContent=e.text,t.addEventListener("click",l),s.appendChild(t)}function c(){const e={};for(const{fieldName:n}of t)e[n]=a[n].value;return e}document.body.appendChild(i)}("Please enter a name",[{fieldName:"name",text:"Name:"}],[{text:"Ok",callback:function(e,t){let n=t.name;console.log(t),ee.setPlayerName(n),ee.createWSClient().addEventListener("open",(()=>{const e={eventName:"joinRequest"};e.data={playerName:n,gameId:Te},ee.sendMessage(JSON.stringify(e))}))}},{text:"Cancel"}]),Ne.setMenu(ke,!0,!0)})()})();